# CSRF

> CSRF: Cross Site Request Forgery(跨站点请求伪造)

> 攻击过程：
1. 用户C打开浏览器，访问受信任网站A，输入用户名及密码请求登录；
2. 用户信息通过认证后，网站A产生 Cookie 信息并返回给浏览器，此时用户C登录成功，可正常发送请求到网站A；
3. 用户在未退出网站A之前，在同一浏览器，打开一个 tab 页访问网站B；
4. 网站B接收到用户请求后，返回一些攻击性代码，并发出一个请求要求访问第三方网站A；
5. 浏览器接收到这些攻击性代码后，根据网站B的请求，在用户不知情的情况下，携带 Cookie 信息向网站A发出请求；
6. 网站A并不知道该请求是由网站B发起的，所以会根据用户C的 Cookie 信息以C的权限处理该请求，导致来自网站B的恶意代码被执行；

> 漏洞检查：
1. 抓取一个正常请求的数据包，去掉 Referer 字段后再重新提交，如果提交有效，那么基本可以确定存在 CSRF 漏洞

> 防御手段：
1. 验证 HTTP Referer 字段；
2. 在请求地址中添加 token 并验证；
3. 在 HTTP 头部自定义属性并验证；

- Referer 字段记录了请求的来源地址；